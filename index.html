<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sliceFunctionDemo</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div id="container">
        <!-- Header -->
        <div id="header">
            <div id="logo">
                <img src="assets/logo.png" alt="„É≠„Ç¥" />
            </div>
            <div id="headerRightSection">
                <div id="comboBox">
                    <div id="comboBoxInput">
                        <div class="frame1248">
                            <select id="projectSelect">
                                <option>Ë™øÂêàÂ∑•Á®ã/Á¨¨3„Éó„É©„É≥„Éà2FL</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div id="searchInput">
                <img src="assets/search.svg" alt="Ê§úÁ¥¢" />
                <input type="text" placeholder="Ê§úÁ¥¢" />
            </div>
        </div>

        <div class="main-content">
            <!-- Sidebar -->
            <div id="sidebar">
                <div id="sideMenu">
                    <div id="sideMenuHeader">
                        <div class="addContentsMenu">
                            <button class="sidebar-button" id="addMarkerBtn" title="„Éû„Éº„Ç´„Éº">
                                <img src="assets/marker.svg" alt="„Éû„Éº„Ç´„Éº" />
                            </button>
                            <button class="sidebar-button" id="addPipeBtn" title="„Éë„Ç§„Éó">
                                <img src="assets/addPipe.svg" alt="„Éë„Ç§„Éó" />
                            </button>
                            <button class="sidebar-button" id="addRulerBtn" title="„É´„Éº„É©„Éº">
                                <img src="assets/ruler.svg" alt="„É´„Éº„É©„Éº" />
                            </button>
                            <button class="sidebar-button" id="addBrickBtn" title="„É¨„É≥„Ç¨">
                                <img src="assets/brick.svg" alt="„É¨„É≥„Ç¨" />
                            </button>
                        </div>
                        <div class="sidebar-divider"></div>
                        <div class="addAssetMenu">
                            <button class="sidebar-button" id="addMachineBtn" title="Ê©üÊ¢∞„ÇíËøΩÂä†" onclick="document.getElementById('fileInput').click()">
                                <img src="assets/addMachine.svg" alt="Ê©üÊ¢∞„ÇíËøΩÂä†" />
                            </button>
                            <button class="sidebar-button" id="addPipeAssetBtn" title="„Éë„Ç§„Éó„ÇíËøΩÂä†">
                                <img src="assets/pipeSector.svg" alt="„Éë„Ç§„Éó„ÇíËøΩÂä†" />
                            </button>
                            <button class="sidebar-button" id="addFlangeBtn" title="„Éï„É©„É≥„Ç∏„ÇíËøΩÂä†">
                                <img src="assets/flange.svg" alt="„Éï„É©„É≥„Ç∏„ÇíËøΩÂä†" />
                            </button>
                            <button class="sidebar-button" id="addFlange2Btn" title="„Éï„É©„É≥„Ç∏2„ÇíËøΩÂä†">
                                <img src="assets/valve.svg" alt="„Éï„É©„É≥„Ç∏2„ÇíËøΩÂä†" />
                            </button>
                        </div>
                    </div>
                    <div id="sideMenuFooter">
                        <button class="sidebar-button" id="newsBtn" title="„Éã„É•„Éº„Çπ">
                            <img src="assets/news.svg" alt="„Éã„É•„Éº„Çπ" />
                        </button>
                        <button class="sidebar-button" id="accountBtn" title="„Ç¢„Ç´„Ç¶„É≥„Éà">
                            <img src="assets/account.svg" alt="„Ç¢„Ç´„Ç¶„É≥„Éà" />
                        </button>
                        <button class="sidebar-button" id="settingsBtn" title="Ë®≠ÂÆö">
                            <img src="assets/settings.svg" alt="Ë®≠ÂÆö" />
                        </button>
                    </div>
                </div>
            </div>
            <div id="viewer">
                <!-- „Çπ„É©„Ç§„Çπ‰∏≠„ÅÆÁôΩÊû† -->
                <div id="operationFrame"></div>

                <!-- „Çπ„É©„Ç§„Çπ‰∏≠„Çπ„ÉÜ„Éº„Çø„Çπ -->
                <div id="slicingStatus" style="display: none;">
                    <div class="slicing-status-corner slicing-status-corner-left">
                        <img src="assets/corner.svg" alt="" />
                    </div>
                    <div id="slicingStatusContainer">
                        <div id="slicingStatusText">„Çπ„É©„Ç§„Çπ‰∏≠...</div>
                        <button id="completeSliceBtn">ÂÆå‰∫Ü„Åô„Çã</button>
                        <div style="width: 1px; height: 28px; background: #c0c3cc;"></div>
                        <button id="cancelSliceBtn">
                            <img src="assets/close.svg" alt="Èñâ„Åò„Çã" />
                        </button>
                    </div>
                    <div class="slicing-status-corner slicing-status-corner-right">
                        <img src="assets/corner.svg" alt="" />
                    </div>
                </div>

                <!-- „Çπ„É©„Ç§„ÇπÂÆå‰∫ÜÊôÇ„ÅÆ„Çπ„ÉÜ„Éº„Çø„Çπ -->
                <div id="sliceViewMode" style="display: none;">
                    <div id="sliceViewModeContainer">
                        <div id="sliceViewModeText">„Çπ„É©„Ç§„Çπ„É¢„Éº„Éâ„ÅßË°®Á§∫‰∏≠</div>
                        <button id="editSliceBtn">Á∑®ÈõÜ„Åô„Çã</button>
                        <div style="width: 1px; height: 28px; background: #c0c3cc;"></div>
                        <button id="closeSliceViewBtn">
                            <img src="assets/close.svg" alt="Èñâ„Åò„Çã" />
                        </button>
                    </div>
                </div>

                <!-- „Ç™„Éó„Ç∑„Éß„É≥„Éë„Éç„É´ -->
                <div id="optionPanel">
                    <div id="optionPanelHeader">
                        <div id="optionPanelTitle">
                            <img id="optionPanelArrow" src="assets/arrow.svg" alt="" />
                            <span>„Ç™„Éó„Ç∑„Éß„É≥„Éë„Éç„É´</span>
                        </div>
                    </div>
                    <div id="optionPanelContent">
                        <button id="fullRangeSliceBtn">ÂÖ®ÁØÑÂõ≤„ÇíË°®Á§∫„Åô„Çã</button>
                        <div class="option-item">
                            <div class="option-label">Â§ñÂÅ¥„ÅÆÁÇπÁæ§„ÇíË°®Á§∫„Åô„Çã</div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="toggleOutsideViewNew" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="option-item">
                            <div class="option-label">Â§©ÁêÉ„ÇíË°®Á§∫„Åô„Çã</div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="toggleSkyboxSlice" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <!-- <div class="option-divider"></div> -->

                    </div>
                </div>

                <div id="dropZone" class="drop-zone">
                    <div>üìÅ</div>
                    <div>PLY„Éï„Ç°„Ç§„É´„Çí„Éâ„É≠„ÉÉ„Éó</div>
                    <div style="font-size: 12px; margin-top: 10px;">„Åæ„Åü„ÅØ„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶ÈÅ∏Êäû</div>
                </div>
                <div id="loadingIndicator">
                    <div>Ë™≠„ÅøËæº„Åø‰∏≠...</div>
                </div>

                <div id="trimmingInfo" class="trimming-info">
                    „Éà„É™„Éü„É≥„Ç∞Êìç‰Ωú‰∏≠  |  Èù¢:ÁßªÂãï   Ëæ∫:ÂõûËª¢   È†ÇÁÇπ:ÂØæËßíÂü∫ÁÇπÂ§âÂΩ¢ | Esc„Ç≠„Éº„Åß„Ç≠„É£„É≥„Çª„É´
                </div>

                <!-- ÂÖ®ÁØÑÂõ≤„Çπ„É©„Ç§„ÇπÁ¢∫Ë™ç„É¢„Éº„ÉÄ„É´ -->
                <div id="fullRangeSliceModal" style="display: none;">
                    <div id="fullRangeSliceModalOverlay"></div>
                    <div id="fullRangeSliceModalContent">
                        <div id="fullRangeSliceModalHeader">
                            <div id="fullRangeSliceModalTitle">
                                <p id="fullRangeSliceModalTitleText">ÂÖ®ÁØÑÂõ≤„ÇíË°®Á§∫„Åó„Çà„ÅÜ„Å®„Åó„Å¶„ÅÑ„Åæ„Åô</p>
                                <p id="fullRangeSliceModalDescription">„Çπ„É©„Ç§„ÇπÁØÑÂõ≤„Çí„É™„Çª„ÉÉ„Éà„Åó„Å¶„ÄÅ„Éó„É©„É≥„ÉàÂÖ®‰Ωì„ÇíË°®Á§∫„Åó„Åæ„Åô„ÅãÔºü</p>
                            </div>
                            <button id="fullRangeSliceModalCloseBtn">
                                <img src="assets/close.svg" alt="Èñâ„Åò„Çã" />
                            </button>
                        </div>
                        <div id="fullRangeSliceModalButtons">
                            <button id="fullRangeSliceModalCancelBtn">„Ç≠„É£„É≥„Çª„É´</button>
                            <button id="fullRangeSliceModalConfirmBtn">Ë°®Á§∫„Åô„Çã</button>
                        </div>
                    </div>
                </div>

                <!-- „Çπ„É©„Ç§„ÇπËß£Èô§Á¢∫Ë™ç„É¢„Éº„ÉÄ„É´ -->
                <div id="removeSliceModal" style="display: none;">
                    <div id="removeSliceModalOverlay"></div>
                    <div id="removeSliceModalContent">
                        <div id="removeSliceModalHeader">
                            <div id="removeSliceModalTitle">
                                <p id="removeSliceModalTitleText">„Çπ„É©„Ç§„Çπ„ÇíËß£Èô§„Åó„Çà„ÅÜ„Å®„Åó„Å¶„ÅÑ„Åæ„Åô</p>
                                <div id="removeSliceModalDescription">
                                    <p>„Çπ„É©„Ç§„Çπ„Åó„ÅüÁØÑÂõ≤„ÇíËß£Èô§„Åó„Çà„ÅÜ„Å®„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
                                    <p>„Åì„ÅÆ„Åæ„ÅæËß£Èô§„Åô„Çã„Å®„ÄÅ„Çπ„É©„Ç§„ÇπË®≠ÂÆö„ÅØÂ§±„Çè„Çå„Åæ„Åô„ÄÇ</p>
                                    <p>„Çà„Çç„Åó„ÅÑ„Åß„Åô„ÅãÔºü</p>
                                </div>
                            </div>
                            <button id="removeSliceModalCloseBtn">
                                <img src="assets/close.svg" alt="Èñâ„Åò„Çã" />
                            </button>
                        </div>
                        <div id="removeSliceModalButtons">
                            <button id="removeSliceModalCancelBtn">„Çπ„É©„Ç§„ÇπË°®Á§∫„ÇíÁ∂≠ÊåÅ„Åô„Çã</button>
                            <button id="removeSliceModalConfirmBtn">„Çπ„É©„Ç§„Çπ„ÇíËß£Èô§„Åô„Çã</button>
                        </div>
                    </div>
                </div>

                <!-- Âêë„ÅçË™øÊï¥„É¢„Éº„ÉÄ„É´ -->
                <div id="orientationModal">
                    <div id="orientationPanel">
                        <h2>üìê Âêë„ÅçË™øÊï¥</h2>
                        <p>„Éû„Ç¶„Çπ„Åß„É¢„Éá„É´„ÇíÂõûËª¢„Åï„Åõ„Å¶Á¢∫Ë™ç„Åó„Å™„Åå„Çâ„ÄÅ<br>„Éú„Çø„É≥„ÅßÊúÄÈÅ©„Å™Âêë„Åç„Å´Ë™øÊï¥„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
                        
                        <div class="preset-controls">
                            <button class="preset-btn" id="presetFront">Ê≠£Èù¢</button>
                            <button class="preset-btn" id="presetTop">‰∏äÈù¢</button>
                            <button class="preset-btn" id="presetSide">ÂÅ¥Èù¢</button>
                            <button class="preset-btn" id="presetIso">Á≠âËßí</button>
                        </div>
                        
                        <div class="orientation-controls">
                            <button class="orientation-btn" id="rotateXPos">XËª∏+90¬∞</button>
                            <button class="orientation-btn" id="rotateYPos">YËª∏+90¬∞</button>
                            <button class="orientation-btn" id="rotateZPos">ZËª∏+90¬∞</button>
                            <button class="orientation-btn" id="rotateXNeg">XËª∏-90¬∞</button>
                            <button class="orientation-btn" id="rotateYNeg">YËª∏-90¬∞</button>
                            <button class="orientation-btn" id="rotateZNeg">ZËª∏-90¬∞</button>
                            <button class="orientation-btn" id="flipX">XËª∏ÂèçËª¢</button>
                            <button class="orientation-btn" id="flipY">YËª∏ÂèçËª¢</button>
                            <button class="orientation-btn" id="flipZ">ZËª∏ÂèçËª¢</button>
                        </div>
                        
                        <div style="display: flex; gap: 15px; justify-content: center;">
                            <button class="btn" id="resetOrientation">„É™„Çª„ÉÉ„Éà</button>
                            <button class="btn" id="confirmOrientation">„Åì„ÅÆÂêë„Åç„ÅßÁ¢∫ÂÆö</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Â∑¶ÂÅ¥„ÅÆ„É°„Éã„É•„Éº -->
            <div id="leftMenu">
                <button id="miniMapButton" title="„Éü„Éã„Éû„ÉÉ„Éó">
                    <img src="assets/miniMap.svg" alt="„Éü„Éã„Éû„ÉÉ„Éó" />
                </button>
            </div>

            <!-- Âè≥‰∏ã„ÅÆ„Ç≥„É≥„Éà„É≠„Éº„É´UI -->
            <div id="controlMenu">
                <div id="viewControl">
                    <div id="viewControlTabs">
                        <button class="view-control-tab" id="orbitTab" title="Orbit">
                            <img src="assets/path.svg" alt="Orbit" />
                        </button>
                        <button class="view-control-tab active" id="lookTab" title="Look">
                            <img src="assets/look.svg" alt="Look" />
                        </button>
                        <button class="view-control-tab" id="thirdTab" title="Third">
                            <img src="assets/fly.svg" alt="Third" />
                        </button>
                    </div>
                </div>
                <div id="bottomMenu">
                    <div id="sliceButton">
                        <button id="toggleTrimBoxNew" title="„Çπ„É©„Ç§„Çπ" disabled>
                            <img src="assets/sliceIcon.svg" alt="„Çπ„É©„Ç§„Çπ" />
                        </button>
                    </div>
                    <div id="modeSwitch">
                        <div class="mode-button-wrapper">
                            <button class="mode-button active" id="mode3D" title="3D„É¢„Éº„Éâ">
                                <img src="assets/3dMode.svg" alt="3D„É¢„Éº„Éâ" />
                            </button>
                        </div>
                        <div class="mode-button-wrapper">
                            <button class="mode-button" id="modeWalkThrough" title="„Ç¶„Ç©„Éº„ÇØ„Çπ„É´„Éº„É¢„Éº„Éâ">
                                <img src="assets/2dMode.svg" alt="„Ç¶„Ç©„Éº„ÇØ„Çπ„É´„Éº„É¢„Éº„Éâ" />
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ÈùûË°®Á§∫„ÅÆ„Éï„Ç°„Ç§„É´ÂÖ•Âäõ -->
        <input type="file" id="fileInput" accept=".ply" style="display: none;" />
    </div>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>
    <script type="module" src="app.js"></script>
</body>
</html>